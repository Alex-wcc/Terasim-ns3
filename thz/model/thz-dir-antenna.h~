
#ifndef THZ_DIR_ANTENNA_H
#define THZ_DIR_ANTENNA_H

#include <ns3/boolean.h>
#include <ns3/simulator.h>
#include <ns3/object.h>
#include <ns3/mobility-model.h>
#include "ns3/nstime.h"
#include "thz-net-device.h"
#include "thz-phy.h"
#include "thz-dir-antenna.h"
#include "ns3/node.h"
#include <list>
#include <vector>
#include <cmath>




namespace ns3 {

class THzDirectionalAntenna : public Object
{
public:
  THzDirectionalAntenna();
  virtual ~THzDirectionalAntenna();
  static TypeId GetTypeId (void);
  void Clear();

  void SetDevice (Ptr<THzNetDevice> device);
  void AttachPhy (Ptr<THzPhy> phy);

  bool CheckAntennaMode (void);
  void SetRxTurningSpeed (double turnSpeed);
  double GetRxTurningSpeed () const;
  void SetMaxGain (double maxGain);
  double GetMaxGain () const;
  void SetBeamwidth (double beamwidthDegrees);
  double GetBeamwidth () const;
  void TuneRxOrientation (); 
  double GetRxOrientation ();

  
  double GetRxGainDb (Ptr<MobilityModel> senderMobility, Ptr<MobilityModel> recvMobility);
  double GetTxGainDb (Ptr<MobilityModel> senderMobility, Ptr<MobilityModel> recvMobility);
  double GetAntennaGain (Ptr<MobilityModel> XnodeMobility, Ptr<MobilityModel> YnodeMobility, bool XnodeMode, bool YnodeMode, double RxorientationRadians);
private:
  Ptr<THzNetDevice> m_device;
  Ptr<THzPhy> m_phy;
  Ptr<Node> m_node;
 
  double m_RxTxMode;

  double m_turnSpeed;
  double m_RxIniAngle;
  double m_exponent; 
  double m_beamwidthRadians;
  double m_beamwidthDegrees;
  double m_TxorientationDegrees;
  double m_TxorientationRadians;
  double m_RxorientationDegrees;
  double m_RxorientationRadians;

 

  double m_maxGain;
  double m_rxgainDb;

  Time m_CurrentTime;
  Time m_SectorTime;  

  EventId m_ScheduleTuneRxOrientation;
  EventId m_GetRxOrientation;
  EventId m_TxGetRxOrientation;
  EventId m_ScheduleNextCalc;
  EventId m_ScheduleGetRxGain;
  EventId m_ScheduleGetTxGain;
  EventId m_ScheduleAddRxGainDb;
  EventId m_ScheduleAddTxGainDb;

  double m_RxGain;
  double m_TxGain;
  double m_rxGain;
  double m_txGain;
  
};



} // namespace ns3


#endif // THZ_DIR_ANTENNA_H
